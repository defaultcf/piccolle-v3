<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">

<dom-module id="x-search">
    <template>
        <style>
        img {
            max-width: 100%;
            max-height: 100vh;
        }
        </style>

        <paper-input label="欲望のままに" no-label-float value="{{str}}">
            <paper-icon-button slot="prefix" icon="search"></paper-icon-button>
        </paper-input>

        <iron-ajax auto
            url="/search"
            params="[[_formatParams(str, n)]]"
            debounce-duration="1000"
            last-response="{{imgs}}"
        ></iron-ajax>

        <template is="dom-repeat" id="menu" items="[[imgs]]">
            <img src="[[item.src]]">
        </template>
    </template>

    <script>
    class XSearch extends Polymer.Element {
        static get is() { return 'x-search'; }
        static get properties() {
            return {
                str: {
                    type: String,
                    value: ''
                },
                n: {
                    type: Number,
                    value: 3
                },
                imgs: Array
            }
        }
        _formatParams(str, n) {
            return {"str": str, "n": n};
        }
    }
    customElements.define(XSearch.is, XSearch);
    </script>
</dom-module>
